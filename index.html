<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8" />
  <title>ËÉñÊ≥¢Ë∑≥Ë∑≥Ë∑≥ v2</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no" />
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    html, body { width: 100%; height: 100%; background: #111; overflow: hidden; }
    canvas { display: block; width: 100vw; height: 100vh; }

    #game-over {
      position: fixed;
      top: 40%;
      left: 50%;
      transform: translateX(-50%);
      color: white;
      font-size: 24px;
      background: rgba(0,0,0,0.8);
      padding: 20px;
      border-radius: 10px;
      display: none;
      z-index: 10;
      text-align: center;
    }

    #controls {
      position: fixed;
      bottom: 20px;
      left: 50%;
      transform: translateX(-50%);
      display: flex;
      gap: 10px;
      z-index: 9;
    }

    .btn {
      width: 60px;
      height: 60px;
      font-size: 28px;
      border: none;
      border-radius: 50%;
      background: rgba(255, 255, 255, 0.2);
      color: white;
      backdrop-filter: blur(4px);
    }

    @media (min-width: 768px) {
      #controls { display: none; } /* Ê°åÊ©ü‰∏çÈ°ØÁ§∫ÊåâÈàï */
    }
  </style>
</head>
<body>
  <div id="game-over">üíÄ ËÉñÊ≥¢Êéâ‰∏ãÂéª‰∫ÜÔºÅ<br/><br/><button onclick="location.reload()">ÈáçÊñ∞ÈñãÂßã</button></div>

  <!-- üì± ÊâãÊ©üÊìç‰ΩúÊåâÈàï -->
  <div id="controls">
    <button class="btn" id="left">‚¨ÖÔ∏è</button>
    <button class="btn" id="up">‚¨ÜÔ∏è</button>
    <button class="btn" id="right">‚û°Ô∏è</button>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/phaser@3/dist/phaser.min.js"></script>
  <script>
    let player, platforms, cursors, camera;
    let gameOver = false;
    let moveLeft = false;
    let moveRight = false;
    let jump = false;

    const config = {
      type: Phaser.AUTO,
      width: window.innerWidth,
      height: window.innerHeight,
      physics: {
        default: 'arcade',
        arcade: {
          gravity: { y: 800 },
          debug: false
        }
      },
      scene: {
        preload,
        create,
        update
      }
    };

    const game = new Phaser.Game(config);

    function preload() {}

    function create() {
      const scene = this;
      camera = scene.cameras.main;

      // Âπ≥Âè∞Áæ§
      platforms = scene.physics.add.staticGroup();
      const pY = [500, 400, 300, 200];
      pY.forEach((y, i) => {
        const p = platforms.create(100 + i * 80, y, null).setScale(2.5, 0.5).refreshBody();
        scene.add.rectangle(p.x, p.y, p.displayWidth, 20, 0x8888ff).setDepth(-1);
      });

      // ËÉñÊ≥¢
      player = scene.physics.add.sprite(200, 100);
      player.body.setSize(30, 30);
      player.setBounce(0.2);
      player.setCollideWorldBounds(false);
      const pokota = scene.add.circle(0, 0, 15, 0xff88cc);
      player.pokotaSprite = pokota;

      scene.physics.add.collider(player, platforms);

      cursors = scene.input.keyboard.createCursorKeys();

      // üì± Á∂ÅÂÆöÊâãÊ©üÊåâÈàï
      document.getElementById('left').addEventListener('touchstart', () => moveLeft = true);
      document.getElementById('left').addEventListener('touchend', () => moveLeft = false);
      document.getElementById('right').addEventListener('touchstart', () => moveRight = true);
      document.getElementById('right').addEventListener('touchend', () => moveRight = false);
      document.getElementById('up').addEventListener('touchstart', () => jump = true);
      document.getElementById('up').addEventListener('touchend', () => jump = false);
    }

    function update() {
      if (gameOver) return;

      player.pokotaSprite.x = player.x;
      player.pokotaSprite.y = player.y;

      let vx = 0;
      if (cursors.left.isDown || moveLeft) vx = -200;
      if (cursors.right.isDown || moveRight) vx = 200;
      player.setVelocityX(vx);

      if ((cursors.up.isDown || jump) && player.body.touching.down) {
        player.setVelocityY(-400);
      }

      if (player.y < camera.scrollY + 200) {
        camera.scrollY = player.y - 200;
      }

      if (player.y > camera.scrollY + config.height + 100) {
        document.getElementById('game-over').style.display = 'block';
        gameOver = true;
      }
    }
  </script>
</body>
</html>